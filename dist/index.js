function n(t){return{all:t=t||new Map,on:function(e,s){var i=t.get(e);i?i.push(s):t.set(e,[s])},off:function(e,s){var i=t.get(e);i&&(s?i.splice(i.indexOf(s)>>>0,1):t.set(e,[]))},emit:function(e,s){var i=t.get(e);i&&i.slice().map(function(h){h(s)}),(i=t.get("*"))&&i.slice().map(function(h){h(e,s)})}}}class r{#t;#s=document.createElement("div");#d=new ResizeObserver(({0:{contentRect:{width:t,height:e}}})=>{if(this.#h&&this.#e!==t)this.#o.emit("widthChanged",this.#e=t);if(this.#n&&this.#i!==e)this.#o.emit("heightChanged",this.#i=e)});#e=0;#i=0;#h;#n;#r=!1;#o=n();constructor(t){let{style:e}=this.#s;if(e.position="absolute",e.visibility="hidden",e.pointerEvents="none",t!==null)this.connect(t)}connect(t){let e=t?typeof t==="string"?document.querySelector(t):t instanceof HTMLElement?t:void 0:document.body;if(!e)throw new ReferenceError(e===null?`CssSurveyor: Can't find ${t}`:"CssSurveyor: Trying to connect an object that is not an HTMLElement");if(this.#t===e)return;this.disconnect(),this.#t=e,this.#c()}get connected(){return this.#t}get events(){return this.#o}get widthExpr(){return this.#h}set widthExpr(t){this.#h=t,this.#c()}get heightExpr(){return this.#n}set heightExpr(t){this.#n=t,this.#c()}get width(){return this.#e}get height(){return this.#i}remeasure(t=!1){if(!this.#r)return;if(this.#h){let{offsetWidth:e}=this.#s;if(t||this.#e!==e)this.events.emit("widthChanged",this.#e=e)}if(this.#n){let{offsetHeight:e}=this.#s;if(t||this.#i!==e)this.events.emit("heightChanged",this.#i=e)}}cleanup(){this.disconnect(),this.events.all.clear()}disconnect(){if(!this.#t)return;this.#d.disconnect(),this.#t.removeChild(this.#s),this.#t=void 0,this.#r=!1,this.#e=0,this.#i=0}#c(){let t=this.#s,e=this.#h,s=this.#n;if(e)t.style.width=e;if(s)t.style.height=s;let i=this.#t;if(!i)return;let h=Boolean(e||s);if(this.#r!==h)if(this.#r=h)i.appendChild(t),this.#d.observe(t);else i.removeChild(t),this.#d.disconnect();this.remeasure()}}export{r as CssSurveyor};

//# debugId=6C0E0FAE3FC6691764756E2164756E21
//# sourceMappingURL=index.js.map
