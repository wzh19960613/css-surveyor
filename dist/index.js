function n(t){return{all:t=t||new Map,on:function(e,s){var i=t.get(e);i?i.push(s):t.set(e,[s])},off:function(e,s){var i=t.get(e);i&&(s?i.splice(i.indexOf(s)>>>0,1):t.set(e,[]))},emit:function(e,s){var i=t.get(e);i&&i.slice().map(function(h){h(s)}),(i=t.get("*"))&&i.slice().map(function(h){h(e,s)})}}}class r{#t;#s=document.createElement("div");#d=new ResizeObserver(([{contentRect:{width:t,height:e}}])=>{if(this.#h&&this.#e!==t)this.events.emit("widthChanged",this.#e=t);if(this.#n&&this.#i!==e)this.events.emit("heightChanged",this.#i=e)});#e=0;#i=0;#h;#n;#r=!1;events=n();constructor(t){const{style:e}=this.#s;if(e.position="absolute",e.visibility="hidden",e.pointerEvents="none",t!==null)this.connect(t)}connect(t){const e=t?typeof t==="string"?document.querySelector(t):t instanceof HTMLElement?t:void 0:document.body;if(!e)throw new ReferenceError(e===null?`CssSurveyor: Can't find ${t}`:"CssSurveyor: Trying to connect an object that is not an HTMLElement");if(this.#t===e)return;this.disconnect(),this.#t=e,this.#o()}get connected(){return this.#t}get widthExpr(){return this.#h}set widthExpr(t){this.#h=t,this.#o()}get heightExpr(){return this.#n}set heightExpr(t){this.#n=t,this.#o()}get width(){return this.#e}get height(){return this.#i}remeasure(){if(!this.#r)return;if(this.#h){const{offsetWidth:t}=this.#s;if(this.#e!==t)this.events.emit("widthChanged",this.#e=t)}if(this.#n){const{offsetHeight:t}=this.#s;if(this.#i!==t)this.events.emit("heightChanged",this.#i=t)}}cleanup(){this.disconnect(),this.events.all.clear()}disconnect(){if(!this.#t)return;this.#d.disconnect(),this.#t.removeChild(this.#s),this.#t=void 0,this.#r=!1,this.#e=0,this.#i=0}#o(){const t=this.#s,e=this.#h,s=this.#n;if(e)t.style.width=e;if(s)t.style.height=s;const i=this.#t;if(!i)return;const h=Boolean(e||s);if(this.#r!==h)if(this.#r=h)i.appendChild(t),this.#d.observe(t);else i.removeChild(t),this.#d.disconnect();this.remeasure()}}export{r as CssSurveyor};

//# debugId=7E3F3376D9C0F28E64756E2164756E21
//# sourceMappingURL=index.js.map
